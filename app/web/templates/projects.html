{% extends "base.html" %}

{% block title %}Projects â€“ Cross-Stitch Pattern Generator{% endblock %}

{% block content %}
<div class="py-10">
  <h2 class="text-3xl font-bold text-gray-800 mb-8">Projects</h2>

  <!-- Create Project form -->
  <div class="bg-white border border-gray-200 rounded-xl p-6 mb-8 shadow-sm">
    <h3 class="text-lg font-semibold text-gray-700 mb-4">New Project</h3>
    <form
      hx-post="/hx/projects/create"
      hx-target="#project-form-feedback"
      hx-swap="innerHTML">
      <div class="flex gap-3 items-start">
        <div class="flex-1">
          <input
            type="text"
            name="name"
            placeholder="Project name"
            required
            class="w-full border border-gray-300 rounded-lg px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-indigo-400" />
        </div>
        <button
          type="submit"
          class="bg-indigo-600 text-white px-5 py-2 rounded-lg text-sm font-medium hover:bg-indigo-700 transition-colors">
          Create
        </button>
      </div>
    </form>
    <div id="project-form-feedback" class="mt-3"></div>
  </div>

  <noscript>
    <p class="text-gray-500 text-sm mb-4">Enable JavaScript to load projects dynamically.</p>
  </noscript>

  <!-- Loading indicator (shown while HTMX fetches the partial) -->
  <div id="projects-loading" class="htmx-indicator flex items-center gap-2 text-gray-400 text-sm mb-4">
    <svg class="animate-spin h-4 w-4 text-indigo-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
      <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
      <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8v8H4z"></path>
    </svg>
    Loading projects&hellip;
  </div>

  <!-- HTMX target: reloads on page load and after every successful project creation -->
  <div
    id="projects-list"
    hx-get="/hx/projects"
    hx-trigger="load, projectsChanged from:body"
    hx-target="#projects-list"
    hx-swap="innerHTML"
    hx-indicator="#projects-loading">
  </div>
</div>
{% endblock %}
